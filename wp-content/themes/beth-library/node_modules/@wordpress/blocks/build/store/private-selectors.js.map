{"version":3,"names":["_rememo","_interopRequireDefault","require","_selectors","_utils","_constants","ROOT_BLOCK_SUPPORTS","filterElementBlockSupports","blockSupports","name","element","filter","support","includes","getSupportedStyles","createSelector","state","blockType","getBlockType","supportKeys","supports","spacing","blockGap","__experimentalSkipSerialization","some","spacingType","push","shadow","Object","keys","STYLE_PROPERTY","forEach","styleName","requiresOptOut","getValueFromObjectPath","blockTypes","exports"],"sources":["@wordpress/blocks/src/store/private-selectors.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport createSelector from 'rememo';\n\n/**\n * Internal dependencies\n */\nimport { getBlockType } from './selectors';\nimport { getValueFromObjectPath } from './utils';\nimport { __EXPERIMENTAL_STYLE_PROPERTY as STYLE_PROPERTY } from '../api/constants';\n\nconst ROOT_BLOCK_SUPPORTS = [\n\t'background',\n\t'backgroundColor',\n\t'color',\n\t'linkColor',\n\t'captionColor',\n\t'buttonColor',\n\t'headingColor',\n\t'fontFamily',\n\t'fontSize',\n\t'fontStyle',\n\t'fontWeight',\n\t'lineHeight',\n\t'padding',\n\t'contentSize',\n\t'wideSize',\n\t'blockGap',\n\t'textDecoration',\n\t'textTransform',\n\t'letterSpacing',\n];\n\n/**\n * Filters the list of supported styles for a given element.\n *\n * @param {string[]}         blockSupports list of supported styles.\n * @param {string|undefined} name          block name.\n * @param {string|undefined} element       element name.\n *\n * @return {string[]} filtered list of supported styles.\n */\nfunction filterElementBlockSupports( blockSupports, name, element ) {\n\treturn blockSupports.filter( ( support ) => {\n\t\tif ( support === 'fontSize' && element === 'heading' ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// This is only available for links\n\t\tif ( support === 'textDecoration' && ! name && element !== 'link' ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// This is only available for heading\n\t\tif (\n\t\t\tsupport === 'textTransform' &&\n\t\t\t! name &&\n\t\t\t! [ 'heading', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6' ].includes(\n\t\t\t\telement\n\t\t\t)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// This is only available for headings\n\t\tif (\n\t\t\tsupport === 'letterSpacing' &&\n\t\t\t! name &&\n\t\t\t! [ 'heading', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6' ].includes(\n\t\t\t\telement\n\t\t\t)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Text columns is only available for blocks.\n\t\tif ( support === 'textColumns' && ! name ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} );\n}\n\n/**\n * Returns the list of supported styles for a given block name and element.\n */\nexport const getSupportedStyles = createSelector(\n\t( state, name, element ) => {\n\t\tif ( ! name ) {\n\t\t\treturn filterElementBlockSupports(\n\t\t\t\tROOT_BLOCK_SUPPORTS,\n\t\t\t\tname,\n\t\t\t\telement\n\t\t\t);\n\t\t}\n\n\t\tconst blockType = getBlockType( state, name );\n\n\t\tif ( ! blockType ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst supportKeys = [];\n\n\t\t// Check for blockGap support.\n\t\t// Block spacing support doesn't map directly to a single style property, so needs to be handled separately.\n\t\t// Also, only allow `blockGap` support if serialization has not been skipped, to be sure global spacing can be applied.\n\t\tif (\n\t\t\tblockType?.supports?.spacing?.blockGap &&\n\t\t\tblockType?.supports?.spacing?.__experimentalSkipSerialization !==\n\t\t\t\ttrue &&\n\t\t\t! blockType?.supports?.spacing?.__experimentalSkipSerialization?.some?.(\n\t\t\t\t( spacingType ) => spacingType === 'blockGap'\n\t\t\t)\n\t\t) {\n\t\t\tsupportKeys.push( 'blockGap' );\n\t\t}\n\n\t\t// check for shadow support\n\t\tif ( blockType?.supports?.shadow ) {\n\t\t\tsupportKeys.push( 'shadow' );\n\t\t}\n\n\t\tObject.keys( STYLE_PROPERTY ).forEach( ( styleName ) => {\n\t\t\tif ( ! STYLE_PROPERTY[ styleName ].support ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Opting out means that, for certain support keys like background color,\n\t\t\t// blocks have to explicitly set the support value false. If the key is\n\t\t\t// unset, we still enable it.\n\t\t\tif ( STYLE_PROPERTY[ styleName ].requiresOptOut ) {\n\t\t\t\tif (\n\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support[ 0 ] in\n\t\t\t\t\t\tblockType.supports &&\n\t\t\t\t\tgetValueFromObjectPath(\n\t\t\t\t\t\tblockType.supports,\n\t\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support\n\t\t\t\t\t) !== false\n\t\t\t\t) {\n\t\t\t\t\tsupportKeys.push( styleName );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tgetValueFromObjectPath(\n\t\t\t\t\tblockType.supports,\n\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support,\n\t\t\t\t\tfalse\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tsupportKeys.push( styleName );\n\t\t\t}\n\t\t} );\n\n\t\treturn filterElementBlockSupports( supportKeys, name, element );\n\t},\n\t( state, name ) => [ state.blockTypes[ name ] ]\n);\n"],"mappings":"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"}