{"version":3,"names":["_element","require","_compose","_toHtmlString","_isCollapsed","_slice","_getTextContent","useCopyHandler","props","propsRef","useRef","current","useRefEffect","element","onCopy","event","record","multilineTag","preserveWhiteSpace","ownerDocument","isCollapsed","contains","activeElement","selectedRecord","slice","plainText","getTextContent","tagName","toLowerCase","html","toHTMLString","value","clipboardData","setData","preventDefault","type","execCommand","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst { record, multilineTag, preserveWhiteSpace } =\n\t\t\t\tpropsRef.current;\n\t\t\tconst { ownerDocument } = element;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst tagName = element.tagName.toLowerCase();\n\n\t\t\tlet html = toHTMLString( {\n\t\t\t\tvalue: selectedRecord,\n\t\t\t\tmultilineTag,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} );\n\n\t\t\tif ( tagName && tagName !== 'span' && tagName !== 'div' ) {\n\t\t\t\thtml = `<${ tagName }>${ html }</${ tagName }>`;\n\t\t\t}\n\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( event.type === 'cut' ) {\n\t\t\t\townerDocument.execCommand( 'delete' );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\telement.addEventListener( 'cut', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t\telement.removeEventListener( 'cut', onCopy );\n\t\t};\n\t}, [] );\n}\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAKA,IAAAE,aAAA,GAAAF,OAAA;AACA,IAAAG,YAAA,GAAAH,OAAA;AACA,IAAAI,MAAA,GAAAJ,OAAA;AACA,IAAAK,eAAA,GAAAL,OAAA;AAZA;AACA;AACA;;AAIA;AACA;AACA;;AAMO,SAASM,cAAcA,CAAEC,KAAK,EAAG;EACvC,MAAMC,QAAQ,GAAG,IAAAC,eAAM,EAAEF,KAAM,CAAC;EAChCC,QAAQ,CAACE,OAAO,GAAGH,KAAK;EACxB,OAAO,IAAAI,qBAAY,EAAIC,OAAO,IAAM;IACnC,SAASC,MAAMA,CAAEC,KAAK,EAAG;MACxB,MAAM;QAAEC,MAAM;QAAEC,YAAY;QAAEC;MAAmB,CAAC,GACjDT,QAAQ,CAACE,OAAO;MACjB,MAAM;QAAEQ;MAAc,CAAC,GAAGN,OAAO;MACjC,IACC,IAAAO,wBAAW,EAAEJ,MAAM,CAACL,OAAQ,CAAC,IAC7B,CAAEE,OAAO,CAACQ,QAAQ,CAAEF,aAAa,CAACG,aAAc,CAAC,EAChD;QACD;MACD;MAEA,MAAMC,cAAc,GAAG,IAAAC,YAAK,EAAER,MAAM,CAACL,OAAQ,CAAC;MAC9C,MAAMc,SAAS,GAAG,IAAAC,8BAAc,EAAEH,cAAe,CAAC;MAClD,MAAMI,OAAO,GAAGd,OAAO,CAACc,OAAO,CAACC,WAAW,CAAC,CAAC;MAE7C,IAAIC,IAAI,GAAG,IAAAC,0BAAY,EAAE;QACxBC,KAAK,EAAER,cAAc;QACrBN,YAAY;QACZC;MACD,CAAE,CAAC;MAEH,IAAKS,OAAO,IAAIA,OAAO,KAAK,MAAM,IAAIA,OAAO,KAAK,KAAK,EAAG;QACzDE,IAAI,GAAI,IAAIF,OAAS,IAAIE,IAAM,KAAKF,OAAS,GAAE;MAChD;MAEAZ,KAAK,CAACiB,aAAa,CAACC,OAAO,CAAE,YAAY,EAAER,SAAU,CAAC;MACtDV,KAAK,CAACiB,aAAa,CAACC,OAAO,CAAE,WAAW,EAAEJ,IAAK,CAAC;MAChDd,KAAK,CAACiB,aAAa,CAACC,OAAO,CAAE,WAAW,EAAE,MAAO,CAAC;MAClDlB,KAAK,CAACmB,cAAc,CAAC,CAAC;MAEtB,IAAKnB,KAAK,CAACoB,IAAI,KAAK,KAAK,EAAG;QAC3BhB,aAAa,CAACiB,WAAW,CAAE,QAAS,CAAC;MACtC;IACD;IAEAvB,OAAO,CAACwB,gBAAgB,CAAE,MAAM,EAAEvB,MAAO,CAAC;IAC1CD,OAAO,CAACwB,gBAAgB,CAAE,KAAK,EAAEvB,MAAO,CAAC;IACzC,OAAO,MAAM;MACZD,OAAO,CAACyB,mBAAmB,CAAE,MAAM,EAAExB,MAAO,CAAC;MAC7CD,OAAO,CAACyB,mBAAmB,CAAE,KAAK,EAAExB,MAAO,CAAC;IAC7C,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}