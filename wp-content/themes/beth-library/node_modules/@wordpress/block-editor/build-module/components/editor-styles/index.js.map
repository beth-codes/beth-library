{"version":3,"names":["colord","extend","namesPlugin","a11yPlugin","SVG","useCallback","useMemo","transformStyles","EDITOR_STYLES_SELECTOR","useDarkThemeBodyClassName","styles","node","ownerDocument","defaultView","body","canvas","querySelector","backgroundColor","tempCanvas","createElement","classList","add","appendChild","getComputedStyle","getPropertyValue","removeChild","colordBackgroundColor","luminance","alpha","remove","EditorStyles","stylesArray","Object","values","transformedStyles","filter","style","css","transformedSvgs","__unstableType","map","assets","join","Fragment","ref","index","key","xmlns","viewBox","width","height","role","visibility","position","left","overflow","dangerouslySetInnerHTML","__html"],"sources":["@wordpress/block-editor/src/components/editor-styles/index.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { colord, extend } from 'colord';\nimport namesPlugin from 'colord/plugins/names';\nimport a11yPlugin from 'colord/plugins/a11y';\n\n/**\n * WordPress dependencies\n */\nimport { SVG } from '@wordpress/components';\nimport { useCallback, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport transformStyles from '../../utils/transform-styles';\n\nconst EDITOR_STYLES_SELECTOR = '.editor-styles-wrapper';\nextend( [ namesPlugin, a11yPlugin ] );\n\nfunction useDarkThemeBodyClassName( styles ) {\n\treturn useCallback(\n\t\t( node ) => {\n\t\t\tif ( ! node ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { ownerDocument } = node;\n\t\t\tconst { defaultView, body } = ownerDocument;\n\t\t\tconst canvas = ownerDocument.querySelector(\n\t\t\t\tEDITOR_STYLES_SELECTOR\n\t\t\t);\n\n\t\t\tlet backgroundColor;\n\n\t\t\tif ( ! canvas ) {\n\t\t\t\t// The real .editor-styles-wrapper element might not exist in the\n\t\t\t\t// DOM, so calculate the background color by creating a fake\n\t\t\t\t// wrapper.\n\t\t\t\tconst tempCanvas = ownerDocument.createElement( 'div' );\n\t\t\t\ttempCanvas.classList.add( 'editor-styles-wrapper' );\n\t\t\t\tbody.appendChild( tempCanvas );\n\n\t\t\t\tbackgroundColor = defaultView\n\t\t\t\t\t?.getComputedStyle( tempCanvas, null )\n\t\t\t\t\t.getPropertyValue( 'background-color' );\n\n\t\t\t\tbody.removeChild( tempCanvas );\n\t\t\t} else {\n\t\t\t\tbackgroundColor = defaultView\n\t\t\t\t\t?.getComputedStyle( canvas, null )\n\t\t\t\t\t.getPropertyValue( 'background-color' );\n\t\t\t}\n\t\t\tconst colordBackgroundColor = colord( backgroundColor );\n\t\t\t// If background is transparent, it should be treated as light color.\n\t\t\tif (\n\t\t\t\tcolordBackgroundColor.luminance() > 0.5 ||\n\t\t\t\tcolordBackgroundColor.alpha() === 0\n\t\t\t) {\n\t\t\t\tbody.classList.remove( 'is-dark-theme' );\n\t\t\t} else {\n\t\t\t\tbody.classList.add( 'is-dark-theme' );\n\t\t\t}\n\t\t},\n\t\t[ styles ]\n\t);\n}\n\nexport default function EditorStyles( { styles } ) {\n\tconst stylesArray = useMemo(\n\t\t() => Object.values( styles ?? [] ),\n\t\t[ styles ]\n\t);\n\tconst transformedStyles = useMemo(\n\t\t() =>\n\t\t\ttransformStyles(\n\t\t\t\tstylesArray.filter( ( style ) => style?.css ),\n\t\t\t\tEDITOR_STYLES_SELECTOR\n\t\t\t),\n\t\t[ stylesArray ]\n\t);\n\n\tconst transformedSvgs = useMemo(\n\t\t() =>\n\t\t\tstylesArray\n\t\t\t\t.filter( ( style ) => style.__unstableType === 'svgs' )\n\t\t\t\t.map( ( style ) => style.assets )\n\t\t\t\t.join( '' ),\n\t\t[ stylesArray ]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ /* Use an empty style element to have a document reference,\n\t\t\t     but this could be any element. */ }\n\t\t\t<style ref={ useDarkThemeBodyClassName( stylesArray ) } />\n\t\t\t{ transformedStyles.map( ( css, index ) => (\n\t\t\t\t<style key={ index }>{ css }</style>\n\t\t\t) ) }\n\t\t\t<SVG\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\tviewBox=\"0 0 0 0\"\n\t\t\t\twidth=\"0\"\n\t\t\t\theight=\"0\"\n\t\t\t\trole=\"none\"\n\t\t\t\tstyle={ {\n\t\t\t\t\tvisibility: 'hidden',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\tleft: '-9999px',\n\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t} }\n\t\t\t\tdangerouslySetInnerHTML={ { __html: transformedSvgs } }\n\t\t\t/>\n\t\t</>\n\t);\n}\n"],"mappings":";AAAA;AACA;AACA;AACA,SAASA,MAAM,EAAEC,MAAM,QAAQ,QAAQ;AACvC,OAAOC,WAAW,MAAM,sBAAsB;AAC9C,OAAOC,UAAU,MAAM,qBAAqB;;AAE5C;AACA;AACA;AACA,SAASC,GAAG,QAAQ,uBAAuB;AAC3C,SAASC,WAAW,EAAEC,OAAO,QAAQ,oBAAoB;;AAEzD;AACA;AACA;AACA,OAAOC,eAAe,MAAM,8BAA8B;AAE1D,MAAMC,sBAAsB,GAAG,wBAAwB;AACvDP,MAAM,CAAE,CAAEC,WAAW,EAAEC,UAAU,CAAG,CAAC;AAErC,SAASM,yBAAyBA,CAAEC,MAAM,EAAG;EAC5C,OAAOL,WAAW,CACfM,IAAI,IAAM;IACX,IAAK,CAAEA,IAAI,EAAG;MACb;IACD;IAEA,MAAM;MAAEC;IAAc,CAAC,GAAGD,IAAI;IAC9B,MAAM;MAAEE,WAAW;MAAEC;IAAK,CAAC,GAAGF,aAAa;IAC3C,MAAMG,MAAM,GAAGH,aAAa,CAACI,aAAa,CACzCR,sBACD,CAAC;IAED,IAAIS,eAAe;IAEnB,IAAK,CAAEF,MAAM,EAAG;MACf;MACA;MACA;MACA,MAAMG,UAAU,GAAGN,aAAa,CAACO,aAAa,CAAE,KAAM,CAAC;MACvDD,UAAU,CAACE,SAAS,CAACC,GAAG,CAAE,uBAAwB,CAAC;MACnDP,IAAI,CAACQ,WAAW,CAAEJ,UAAW,CAAC;MAE9BD,eAAe,GAAGJ,WAAW,EAC1BU,gBAAgB,CAAEL,UAAU,EAAE,IAAK,CAAC,CACrCM,gBAAgB,CAAE,kBAAmB,CAAC;MAExCV,IAAI,CAACW,WAAW,CAAEP,UAAW,CAAC;IAC/B,CAAC,MAAM;MACND,eAAe,GAAGJ,WAAW,EAC1BU,gBAAgB,CAAER,MAAM,EAAE,IAAK,CAAC,CACjCS,gBAAgB,CAAE,kBAAmB,CAAC;IACzC;IACA,MAAME,qBAAqB,GAAG1B,MAAM,CAAEiB,eAAgB,CAAC;IACvD;IACA,IACCS,qBAAqB,CAACC,SAAS,CAAC,CAAC,GAAG,GAAG,IACvCD,qBAAqB,CAACE,KAAK,CAAC,CAAC,KAAK,CAAC,EAClC;MACDd,IAAI,CAACM,SAAS,CAACS,MAAM,CAAE,eAAgB,CAAC;IACzC,CAAC,MAAM;MACNf,IAAI,CAACM,SAAS,CAACC,GAAG,CAAE,eAAgB,CAAC;IACtC;EACD,CAAC,EACD,CAAEX,MAAM,CACT,CAAC;AACF;AAEA,eAAe,SAASoB,YAAYA,CAAE;EAAEpB;AAAO,CAAC,EAAG;EAClD,MAAMqB,WAAW,GAAGzB,OAAO,CAC1B,MAAM0B,MAAM,CAACC,MAAM,CAAEvB,MAAM,aAANA,MAAM,cAANA,MAAM,GAAI,EAAG,CAAC,EACnC,CAAEA,MAAM,CACT,CAAC;EACD,MAAMwB,iBAAiB,GAAG5B,OAAO,CAChC,MACCC,eAAe,CACdwB,WAAW,CAACI,MAAM,CAAIC,KAAK,IAAMA,KAAK,EAAEC,GAAI,CAAC,EAC7C7B,sBACD,CAAC,EACF,CAAEuB,WAAW,CACd,CAAC;EAED,MAAMO,eAAe,GAAGhC,OAAO,CAC9B,MACCyB,WAAW,CACTI,MAAM,CAAIC,KAAK,IAAMA,KAAK,CAACG,cAAc,KAAK,MAAO,CAAC,CACtDC,GAAG,CAAIJ,KAAK,IAAMA,KAAK,CAACK,MAAO,CAAC,CAChCC,IAAI,CAAE,EAAG,CAAC,EACb,CAAEX,WAAW,CACd,CAAC;EAED,OACCZ,aAAA,CAAAwB,QAAA,QAGCxB,aAAA;IAAOyB,GAAG,EAAGnC,yBAAyB,CAAEsB,WAAY;EAAG,CAAE,CAAC,EACxDG,iBAAiB,CAACM,GAAG,CAAE,CAAEH,GAAG,EAAEQ,KAAK,KACpC1B,aAAA;IAAO2B,GAAG,EAAGD;EAAO,GAAGR,GAAY,CAClC,CAAC,EACHlB,aAAA,CAACf,GAAG;IACH2C,KAAK,EAAC,4BAA4B;IAClCC,OAAO,EAAC,SAAS;IACjBC,KAAK,EAAC,GAAG;IACTC,MAAM,EAAC,GAAG;IACVC,IAAI,EAAC,MAAM;IACXf,KAAK,EAAG;MACPgB,UAAU,EAAE,QAAQ;MACpBC,QAAQ,EAAE,UAAU;MACpBC,IAAI,EAAE,SAAS;MACfC,QAAQ,EAAE;IACX,CAAG;IACHC,uBAAuB,EAAG;MAAEC,MAAM,EAAEnB;IAAgB;EAAG,CACvD,CACA,CAAC;AAEL"}