{"version":3,"names":["_element","require","_classnames","_interopRequireDefault","_compose","_popover","_shortcut","TOOLTIP_DELAY","exports","eventCatcher","createElement","className","getDisabledElement","eventHandlers","child","childrenWithPopover","mergedRefs","cloneElement","children","ref","getRegularElement","addPopoverToGrandchildren","anchor","grandchildren","isOver","offset","position","shortcut","text","props","concatChildren","default","focusOnMount","classNames","animate","shift","emitToChild","eventName","event","Children","count","only","disabled","Tooltip","delay","popoverProps","isMouseDown","setIsMouseDown","useState","setIsOver","delayedSetIsOver","useDebounce","popoverAnchor","setPopoverAnchor","existingChildRef","toArray","mergedChildRefs","useMergeRefs","createMouseDown","target","tagName","document","addEventListener","cancelIsMouseDown","createMouseUp","removeEventListener","createMouseEvent","type","createToggleIsOver","isDelayed","currentTarget","cancel","_isOver","includes","clearOnUnmount","useEffect","process","env","NODE_ENV","console","error","onMouseEnter","onMouseLeave","onClick","onFocus","onBlur","onMouseDown","getElementWithPopover","popoverData","_default"],"sources":["@wordpress/components/src/tooltip/index.js"],"sourcesContent":["// @ts-nocheck\n\n/**\n * External dependencies\n */\nimport classNames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tChildren,\n\tcloneElement,\n\tconcatChildren,\n\tuseEffect,\n\tuseState,\n} from '@wordpress/element';\nimport { useDebounce, useMergeRefs } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport Popover from '../popover';\nimport Shortcut from '../shortcut';\n\n/**\n * Time over children to wait before showing tooltip\n *\n * @type {number}\n */\nexport const TOOLTIP_DELAY = 700;\n\nconst eventCatcher = <div className=\"event-catcher\" />;\n\nconst getDisabledElement = ( {\n\teventHandlers,\n\tchild,\n\tchildrenWithPopover,\n\tmergedRefs,\n} ) => {\n\treturn cloneElement(\n\t\t<span className=\"disabled-element-wrapper\">\n\t\t\t{ cloneElement( eventCatcher, eventHandlers ) }\n\t\t\t{ cloneElement( child, {\n\t\t\t\tchildren: childrenWithPopover,\n\t\t\t\tref: mergedRefs,\n\t\t\t} ) }\n\t\t</span>,\n\t\t{ ...eventHandlers }\n\t);\n};\n\nconst getRegularElement = ( {\n\tchild,\n\teventHandlers,\n\tchildrenWithPopover,\n\tmergedRefs,\n} ) => {\n\treturn cloneElement( child, {\n\t\t...eventHandlers,\n\t\tchildren: childrenWithPopover,\n\t\tref: mergedRefs,\n\t} );\n};\n\nconst addPopoverToGrandchildren = ( {\n\tanchor,\n\tgrandchildren,\n\tisOver,\n\toffset,\n\tposition,\n\tshortcut,\n\ttext,\n\tclassName,\n\t...props\n} ) =>\n\tconcatChildren(\n\t\tgrandchildren,\n\t\tisOver && (\n\t\t\t<Popover\n\t\t\t\tfocusOnMount={ false }\n\t\t\t\tposition={ position }\n\t\t\t\tclassName={ classNames( 'components-tooltip', className ) }\n\t\t\t\taria-hidden=\"true\"\n\t\t\t\tanimate={ false }\n\t\t\t\toffset={ offset }\n\t\t\t\tanchor={ anchor }\n\t\t\t\tshift\n\t\t\t\t{ ...props }\n\t\t\t>\n\t\t\t\t{ text }\n\t\t\t\t<Shortcut\n\t\t\t\t\tclassName=\"components-tooltip__shortcut\"\n\t\t\t\t\tshortcut={ shortcut }\n\t\t\t\t/>\n\t\t\t</Popover>\n\t\t)\n\t);\n\nconst emitToChild = ( children, eventName, event ) => {\n\tif ( Children.count( children ) !== 1 ) {\n\t\treturn;\n\t}\n\n\tconst child = Children.only( children );\n\n\t// If the underlying element is disabled, do not emit the event.\n\tif ( child.props.disabled ) {\n\t\treturn;\n\t}\n\n\tif ( typeof child.props[ eventName ] === 'function' ) {\n\t\tchild.props[ eventName ]( event );\n\t}\n};\n\nfunction Tooltip( props ) {\n\tconst {\n\t\tchildren,\n\t\tposition = 'bottom middle',\n\t\ttext,\n\t\tshortcut,\n\t\tdelay = TOOLTIP_DELAY,\n\t\t...popoverProps\n\t} = props;\n\t/**\n\t * Whether a mouse is currently pressed, used in determining whether\n\t * to handle a focus event as displaying the tooltip immediately.\n\t *\n\t * @type {boolean}\n\t */\n\tconst [ isMouseDown, setIsMouseDown ] = useState( false );\n\tconst [ isOver, setIsOver ] = useState( false );\n\tconst delayedSetIsOver = useDebounce( setIsOver, delay );\n\t// Using internal state (instead of a ref) for the popover anchor to make sure\n\t// that the component re-renders when the anchor updates.\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\n\n\t// Create a reference to the Tooltip's child, to be passed to the Popover\n\t// so that the Tooltip can be correctly positioned. Also, merge with the\n\t// existing ref for the first child, so that its ref is preserved.\n\tconst existingChildRef = Children.toArray( children )[ 0 ]?.ref;\n\tconst mergedChildRefs = useMergeRefs( [\n\t\tsetPopoverAnchor,\n\t\texistingChildRef,\n\t] );\n\n\tconst createMouseDown = ( event ) => {\n\t\t// In firefox, the mouse down event is also fired when the select\n\t\t// list is chosen.\n\t\t// Cancel further processing because re-rendering of child components\n\t\t// causes onChange to be triggered with the old value.\n\t\t// See https://github.com/WordPress/gutenberg/pull/42483\n\t\tif ( event.target.tagName === 'OPTION' ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Preserve original child callback behavior.\n\t\temitToChild( children, 'onMouseDown', event );\n\n\t\t// On mouse down, the next `mouseup` should revert the value of the\n\t\t// instance property and remove its own event handler. The bind is\n\t\t// made on the document since the `mouseup` might not occur within\n\t\t// the bounds of the element.\n\t\tdocument.addEventListener( 'mouseup', cancelIsMouseDown );\n\t\tsetIsMouseDown( true );\n\t};\n\n\tconst createMouseUp = ( event ) => {\n\t\t// In firefox, the mouse up event is also fired when the select\n\t\t// list is chosen.\n\t\t// Cancel further processing because re-rendering of child components\n\t\t// causes onChange to be triggered with the old value.\n\t\t// See https://github.com/WordPress/gutenberg/pull/42483\n\t\tif ( event.target.tagName === 'OPTION' ) {\n\t\t\treturn;\n\t\t}\n\n\t\temitToChild( children, 'onMouseUp', event );\n\t\tdocument.removeEventListener( 'mouseup', cancelIsMouseDown );\n\t\tsetIsMouseDown( false );\n\t};\n\n\tconst createMouseEvent = ( type ) => {\n\t\tif ( type === 'mouseUp' ) return createMouseUp;\n\t\tif ( type === 'mouseDown' ) return createMouseDown;\n\t};\n\n\t/**\n\t * Prebound `isInMouseDown` handler, created as a constant reference to\n\t * assure ability to remove in component unmount.\n\t *\n\t * @type {Function}\n\t */\n\tconst cancelIsMouseDown = createMouseEvent( 'mouseUp' );\n\n\tconst createToggleIsOver = ( eventName, isDelayed ) => {\n\t\treturn ( event ) => {\n\t\t\t// Preserve original child callback behavior.\n\t\t\temitToChild( children, eventName, event );\n\n\t\t\t// Mouse events behave unreliably in React for disabled elements,\n\t\t\t// firing on mouseenter but not mouseleave.  Further, the default\n\t\t\t// behavior for disabled elements in some browsers is to ignore\n\t\t\t// mouse events. Don't bother trying to handle them.\n\t\t\t//\n\t\t\t// See: https://github.com/facebook/react/issues/4251\n\t\t\tif ( event.currentTarget.disabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// A focus event will occur as a result of a mouse click, but it\n\t\t\t// should be disambiguated between interacting with the button and\n\t\t\t// using an explicit focus shift as a cue to display the tooltip.\n\t\t\tif ( 'focus' === event.type && isMouseDown ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Needed in case unsetting is over while delayed set pending, i.e.\n\t\t\t// quickly blur/mouseleave before delayedSetIsOver is called.\n\t\t\tdelayedSetIsOver.cancel();\n\n\t\t\tconst _isOver = [ 'focus', 'mouseenter' ].includes( event.type );\n\t\t\tif ( _isOver === isOver ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isDelayed ) {\n\t\t\t\tdelayedSetIsOver( _isOver );\n\t\t\t} else {\n\t\t\t\tsetIsOver( _isOver );\n\t\t\t}\n\t\t};\n\t};\n\tconst clearOnUnmount = () => {\n\t\tdelayedSetIsOver.cancel();\n\t\tdocument.removeEventListener( 'mouseup', cancelIsMouseDown );\n\t};\n\n\t// Ignore reason: updating the deps array here could cause unexpected changes in behavior.\n\t// Deferring until a more detailed investigation/refactor can be performed.\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tuseEffect( () => clearOnUnmount, [] );\n\n\tif ( Children.count( children ) !== 1 ) {\n\t\tif ( 'development' === process.env.NODE_ENV ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(\n\t\t\t\t'Tooltip should be called with only a single child element.'\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tconst eventHandlers = {\n\t\tonMouseEnter: createToggleIsOver( 'onMouseEnter', true ),\n\t\tonMouseLeave: createToggleIsOver( 'onMouseLeave' ),\n\t\tonClick: createToggleIsOver( 'onClick' ),\n\t\tonFocus: createToggleIsOver( 'onFocus' ),\n\t\tonBlur: createToggleIsOver( 'onBlur' ),\n\t\tonMouseDown: createMouseEvent( 'mouseDown' ),\n\t};\n\n\tconst child = Children.only( children );\n\tconst { children: grandchildren, disabled } = child.props;\n\tconst getElementWithPopover = disabled\n\t\t? getDisabledElement\n\t\t: getRegularElement;\n\n\tconst popoverData = {\n\t\tanchor: popoverAnchor,\n\t\tisOver,\n\t\toffset: 4,\n\t\tposition,\n\t\tshortcut,\n\t\ttext,\n\t};\n\tconst childrenWithPopover = addPopoverToGrandchildren( {\n\t\tgrandchildren,\n\t\t...popoverData,\n\t\t...popoverProps,\n\t} );\n\n\treturn getElementWithPopover( {\n\t\tchild,\n\t\teventHandlers,\n\t\tchildrenWithPopover,\n\t\tmergedRefs: mergedChildRefs,\n\t} );\n}\n\nexport default Tooltip;\n"],"mappings":";;;;;;;AAUA,IAAAA,QAAA,GAAAC,OAAA;AALA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AAYA,IAAAG,QAAA,GAAAH,OAAA;AAKA,IAAAI,QAAA,GAAAF,sBAAA,CAAAF,OAAA;AACA,IAAAK,SAAA,GAAAH,sBAAA,CAAAF,OAAA;AAvBA;;AAEA;AACA;AACA;;AAGA;AACA;AACA;;AAUA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACO,MAAMM,aAAa,GAAG,GAAG;AAACC,OAAA,CAAAD,aAAA,GAAAA,aAAA;AAEjC,MAAME,YAAY,GAAG,IAAAT,QAAA,CAAAU,aAAA;EAAKC,SAAS,EAAC;AAAe,CAAE,CAAC;AAEtD,MAAMC,kBAAkB,GAAGA,CAAE;EAC5BC,aAAa;EACbC,KAAK;EACLC,mBAAmB;EACnBC;AACD,CAAC,KAAM;EACN,OAAO,IAAAC,qBAAY,EAClB,IAAAjB,QAAA,CAAAU,aAAA;IAAMC,SAAS,EAAC;EAA0B,GACvC,IAAAM,qBAAY,EAAER,YAAY,EAAEI,aAAc,CAAC,EAC3C,IAAAI,qBAAY,EAAEH,KAAK,EAAE;IACtBI,QAAQ,EAAEH,mBAAmB;IAC7BI,GAAG,EAAEH;EACN,CAAE,CACG,CAAC,EACP;IAAE,GAAGH;EAAc,CACpB,CAAC;AACF,CAAC;AAED,MAAMO,iBAAiB,GAAGA,CAAE;EAC3BN,KAAK;EACLD,aAAa;EACbE,mBAAmB;EACnBC;AACD,CAAC,KAAM;EACN,OAAO,IAAAC,qBAAY,EAAEH,KAAK,EAAE;IAC3B,GAAGD,aAAa;IAChBK,QAAQ,EAAEH,mBAAmB;IAC7BI,GAAG,EAAEH;EACN,CAAE,CAAC;AACJ,CAAC;AAED,MAAMK,yBAAyB,GAAGA,CAAE;EACnCC,MAAM;EACNC,aAAa;EACbC,MAAM;EACNC,MAAM;EACNC,QAAQ;EACRC,QAAQ;EACRC,IAAI;EACJjB,SAAS;EACT,GAAGkB;AACJ,CAAC,KACA,IAAAC,uBAAc,EACbP,aAAa,EACbC,MAAM,IACL,IAAAxB,QAAA,CAAAU,aAAA,EAACL,QAAA,CAAA0B,OAAO;EACPC,YAAY,EAAG,KAAO;EACtBN,QAAQ,EAAGA,QAAU;EACrBf,SAAS,EAAG,IAAAsB,mBAAU,EAAE,oBAAoB,EAAEtB,SAAU,CAAG;EAC3D,eAAY,MAAM;EAClBuB,OAAO,EAAG,KAAO;EACjBT,MAAM,EAAGA,MAAQ;EACjBH,MAAM,EAAGA,MAAQ;EACjBa,KAAK;EAAA,GACAN;AAAK,GAERD,IAAI,EACN,IAAA5B,QAAA,CAAAU,aAAA,EAACJ,SAAA,CAAAyB,OAAQ;EACRpB,SAAS,EAAC,8BAA8B;EACxCgB,QAAQ,EAAGA;AAAU,CACrB,CACO,CAEX,CAAC;AAEF,MAAMS,WAAW,GAAGA,CAAElB,QAAQ,EAAEmB,SAAS,EAAEC,KAAK,KAAM;EACrD,IAAKC,iBAAQ,CAACC,KAAK,CAAEtB,QAAS,CAAC,KAAK,CAAC,EAAG;IACvC;EACD;EAEA,MAAMJ,KAAK,GAAGyB,iBAAQ,CAACE,IAAI,CAAEvB,QAAS,CAAC;;EAEvC;EACA,IAAKJ,KAAK,CAACe,KAAK,CAACa,QAAQ,EAAG;IAC3B;EACD;EAEA,IAAK,OAAO5B,KAAK,CAACe,KAAK,CAAEQ,SAAS,CAAE,KAAK,UAAU,EAAG;IACrDvB,KAAK,CAACe,KAAK,CAAEQ,SAAS,CAAE,CAAEC,KAAM,CAAC;EAClC;AACD,CAAC;AAED,SAASK,OAAOA,CAAEd,KAAK,EAAG;EACzB,MAAM;IACLX,QAAQ;IACRQ,QAAQ,GAAG,eAAe;IAC1BE,IAAI;IACJD,QAAQ;IACRiB,KAAK,GAAGrC,aAAa;IACrB,GAAGsC;EACJ,CAAC,GAAGhB,KAAK;EACT;AACD;AACA;AACA;AACA;AACA;EACC,MAAM,CAAEiB,WAAW,EAAEC,cAAc,CAAE,GAAG,IAAAC,iBAAQ,EAAE,KAAM,CAAC;EACzD,MAAM,CAAExB,MAAM,EAAEyB,SAAS,CAAE,GAAG,IAAAD,iBAAQ,EAAE,KAAM,CAAC;EAC/C,MAAME,gBAAgB,GAAG,IAAAC,oBAAW,EAAEF,SAAS,EAAEL,KAAM,CAAC;EACxD;EACA;EACA,MAAM,CAAEQ,aAAa,EAAEC,gBAAgB,CAAE,GAAG,IAAAL,iBAAQ,EAAE,IAAK,CAAC;;EAE5D;EACA;EACA;EACA,MAAMM,gBAAgB,GAAGf,iBAAQ,CAACgB,OAAO,CAAErC,QAAS,CAAC,CAAE,CAAC,CAAE,EAAEC,GAAG;EAC/D,MAAMqC,eAAe,GAAG,IAAAC,qBAAY,EAAE,CACrCJ,gBAAgB,EAChBC,gBAAgB,CACf,CAAC;EAEH,MAAMI,eAAe,GAAKpB,KAAK,IAAM;IACpC;IACA;IACA;IACA;IACA;IACA,IAAKA,KAAK,CAACqB,MAAM,CAACC,OAAO,KAAK,QAAQ,EAAG;MACxC;IACD;;IAEA;IACAxB,WAAW,CAAElB,QAAQ,EAAE,aAAa,EAAEoB,KAAM,CAAC;;IAE7C;IACA;IACA;IACA;IACAuB,QAAQ,CAACC,gBAAgB,CAAE,SAAS,EAAEC,iBAAkB,CAAC;IACzDhB,cAAc,CAAE,IAAK,CAAC;EACvB,CAAC;EAED,MAAMiB,aAAa,GAAK1B,KAAK,IAAM;IAClC;IACA;IACA;IACA;IACA;IACA,IAAKA,KAAK,CAACqB,MAAM,CAACC,OAAO,KAAK,QAAQ,EAAG;MACxC;IACD;IAEAxB,WAAW,CAAElB,QAAQ,EAAE,WAAW,EAAEoB,KAAM,CAAC;IAC3CuB,QAAQ,CAACI,mBAAmB,CAAE,SAAS,EAAEF,iBAAkB,CAAC;IAC5DhB,cAAc,CAAE,KAAM,CAAC;EACxB,CAAC;EAED,MAAMmB,gBAAgB,GAAKC,IAAI,IAAM;IACpC,IAAKA,IAAI,KAAK,SAAS,EAAG,OAAOH,aAAa;IAC9C,IAAKG,IAAI,KAAK,WAAW,EAAG,OAAOT,eAAe;EACnD,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;EACC,MAAMK,iBAAiB,GAAGG,gBAAgB,CAAE,SAAU,CAAC;EAEvD,MAAME,kBAAkB,GAAGA,CAAE/B,SAAS,EAAEgC,SAAS,KAAM;IACtD,OAAS/B,KAAK,IAAM;MACnB;MACAF,WAAW,CAAElB,QAAQ,EAAEmB,SAAS,EAAEC,KAAM,CAAC;;MAEzC;MACA;MACA;MACA;MACA;MACA;MACA,IAAKA,KAAK,CAACgC,aAAa,CAAC5B,QAAQ,EAAG;QACnC;MACD;;MAEA;MACA;MACA;MACA,IAAK,OAAO,KAAKJ,KAAK,CAAC6B,IAAI,IAAIrB,WAAW,EAAG;QAC5C;MACD;;MAEA;MACA;MACAI,gBAAgB,CAACqB,MAAM,CAAC,CAAC;MAEzB,MAAMC,OAAO,GAAG,CAAE,OAAO,EAAE,YAAY,CAAE,CAACC,QAAQ,CAAEnC,KAAK,CAAC6B,IAAK,CAAC;MAChE,IAAKK,OAAO,KAAKhD,MAAM,EAAG;QACzB;MACD;MAEA,IAAK6C,SAAS,EAAG;QAChBnB,gBAAgB,CAAEsB,OAAQ,CAAC;MAC5B,CAAC,MAAM;QACNvB,SAAS,CAAEuB,OAAQ,CAAC;MACrB;IACD,CAAC;EACF,CAAC;EACD,MAAME,cAAc,GAAGA,CAAA,KAAM;IAC5BxB,gBAAgB,CAACqB,MAAM,CAAC,CAAC;IACzBV,QAAQ,CAACI,mBAAmB,CAAE,SAAS,EAAEF,iBAAkB,CAAC;EAC7D,CAAC;;EAED;EACA;EACA;EACA,IAAAY,kBAAS,EAAE,MAAMD,cAAc,EAAE,EAAG,CAAC;EAErC,IAAKnC,iBAAQ,CAACC,KAAK,CAAEtB,QAAS,CAAC,KAAK,CAAC,EAAG;IACvC,IAAK,aAAa,KAAK0D,OAAO,CAACC,GAAG,CAACC,QAAQ,EAAG;MAC7C;MACAC,OAAO,CAACC,KAAK,CACZ,4DACD,CAAC;IACF;IAEA,OAAO9D,QAAQ;EAChB;EAEA,MAAML,aAAa,GAAG;IACrBoE,YAAY,EAAEb,kBAAkB,CAAE,cAAc,EAAE,IAAK,CAAC;IACxDc,YAAY,EAAEd,kBAAkB,CAAE,cAAe,CAAC;IAClDe,OAAO,EAAEf,kBAAkB,CAAE,SAAU,CAAC;IACxCgB,OAAO,EAAEhB,kBAAkB,CAAE,SAAU,CAAC;IACxCiB,MAAM,EAAEjB,kBAAkB,CAAE,QAAS,CAAC;IACtCkB,WAAW,EAAEpB,gBAAgB,CAAE,WAAY;EAC5C,CAAC;EAED,MAAMpD,KAAK,GAAGyB,iBAAQ,CAACE,IAAI,CAAEvB,QAAS,CAAC;EACvC,MAAM;IAAEA,QAAQ,EAAEK,aAAa;IAAEmB;EAAS,CAAC,GAAG5B,KAAK,CAACe,KAAK;EACzD,MAAM0D,qBAAqB,GAAG7C,QAAQ,GACnC9B,kBAAkB,GAClBQ,iBAAiB;EAEpB,MAAMoE,WAAW,GAAG;IACnBlE,MAAM,EAAE8B,aAAa;IACrB5B,MAAM;IACNC,MAAM,EAAE,CAAC;IACTC,QAAQ;IACRC,QAAQ;IACRC;EACD,CAAC;EACD,MAAMb,mBAAmB,GAAGM,yBAAyB,CAAE;IACtDE,aAAa;IACb,GAAGiE,WAAW;IACd,GAAG3C;EACJ,CAAE,CAAC;EAEH,OAAO0C,qBAAqB,CAAE;IAC7BzE,KAAK;IACLD,aAAa;IACbE,mBAAmB;IACnBC,UAAU,EAAEwC;EACb,CAAE,CAAC;AACJ;AAAC,IAAAiC,QAAA,GAEc9C,OAAO;AAAAnC,OAAA,CAAAuB,OAAA,GAAA0D,QAAA"}