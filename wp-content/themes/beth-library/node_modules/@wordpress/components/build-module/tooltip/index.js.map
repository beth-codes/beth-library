{"version":3,"names":["classNames","Children","cloneElement","concatChildren","useEffect","useState","useDebounce","useMergeRefs","Popover","Shortcut","TOOLTIP_DELAY","eventCatcher","createElement","className","getDisabledElement","eventHandlers","child","childrenWithPopover","mergedRefs","children","ref","getRegularElement","addPopoverToGrandchildren","anchor","grandchildren","isOver","offset","position","shortcut","text","props","focusOnMount","animate","shift","emitToChild","eventName","event","count","only","disabled","Tooltip","delay","popoverProps","isMouseDown","setIsMouseDown","setIsOver","delayedSetIsOver","popoverAnchor","setPopoverAnchor","existingChildRef","toArray","mergedChildRefs","createMouseDown","target","tagName","document","addEventListener","cancelIsMouseDown","createMouseUp","removeEventListener","createMouseEvent","type","createToggleIsOver","isDelayed","currentTarget","cancel","_isOver","includes","clearOnUnmount","process","env","NODE_ENV","console","error","onMouseEnter","onMouseLeave","onClick","onFocus","onBlur","onMouseDown","getElementWithPopover","popoverData"],"sources":["@wordpress/components/src/tooltip/index.js"],"sourcesContent":["// @ts-nocheck\n\n/**\n * External dependencies\n */\nimport classNames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tChildren,\n\tcloneElement,\n\tconcatChildren,\n\tuseEffect,\n\tuseState,\n} from '@wordpress/element';\nimport { useDebounce, useMergeRefs } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport Popover from '../popover';\nimport Shortcut from '../shortcut';\n\n/**\n * Time over children to wait before showing tooltip\n *\n * @type {number}\n */\nexport const TOOLTIP_DELAY = 700;\n\nconst eventCatcher = <div className=\"event-catcher\" />;\n\nconst getDisabledElement = ( {\n\teventHandlers,\n\tchild,\n\tchildrenWithPopover,\n\tmergedRefs,\n} ) => {\n\treturn cloneElement(\n\t\t<span className=\"disabled-element-wrapper\">\n\t\t\t{ cloneElement( eventCatcher, eventHandlers ) }\n\t\t\t{ cloneElement( child, {\n\t\t\t\tchildren: childrenWithPopover,\n\t\t\t\tref: mergedRefs,\n\t\t\t} ) }\n\t\t</span>,\n\t\t{ ...eventHandlers }\n\t);\n};\n\nconst getRegularElement = ( {\n\tchild,\n\teventHandlers,\n\tchildrenWithPopover,\n\tmergedRefs,\n} ) => {\n\treturn cloneElement( child, {\n\t\t...eventHandlers,\n\t\tchildren: childrenWithPopover,\n\t\tref: mergedRefs,\n\t} );\n};\n\nconst addPopoverToGrandchildren = ( {\n\tanchor,\n\tgrandchildren,\n\tisOver,\n\toffset,\n\tposition,\n\tshortcut,\n\ttext,\n\tclassName,\n\t...props\n} ) =>\n\tconcatChildren(\n\t\tgrandchildren,\n\t\tisOver && (\n\t\t\t<Popover\n\t\t\t\tfocusOnMount={ false }\n\t\t\t\tposition={ position }\n\t\t\t\tclassName={ classNames( 'components-tooltip', className ) }\n\t\t\t\taria-hidden=\"true\"\n\t\t\t\tanimate={ false }\n\t\t\t\toffset={ offset }\n\t\t\t\tanchor={ anchor }\n\t\t\t\tshift\n\t\t\t\t{ ...props }\n\t\t\t>\n\t\t\t\t{ text }\n\t\t\t\t<Shortcut\n\t\t\t\t\tclassName=\"components-tooltip__shortcut\"\n\t\t\t\t\tshortcut={ shortcut }\n\t\t\t\t/>\n\t\t\t</Popover>\n\t\t)\n\t);\n\nconst emitToChild = ( children, eventName, event ) => {\n\tif ( Children.count( children ) !== 1 ) {\n\t\treturn;\n\t}\n\n\tconst child = Children.only( children );\n\n\t// If the underlying element is disabled, do not emit the event.\n\tif ( child.props.disabled ) {\n\t\treturn;\n\t}\n\n\tif ( typeof child.props[ eventName ] === 'function' ) {\n\t\tchild.props[ eventName ]( event );\n\t}\n};\n\nfunction Tooltip( props ) {\n\tconst {\n\t\tchildren,\n\t\tposition = 'bottom middle',\n\t\ttext,\n\t\tshortcut,\n\t\tdelay = TOOLTIP_DELAY,\n\t\t...popoverProps\n\t} = props;\n\t/**\n\t * Whether a mouse is currently pressed, used in determining whether\n\t * to handle a focus event as displaying the tooltip immediately.\n\t *\n\t * @type {boolean}\n\t */\n\tconst [ isMouseDown, setIsMouseDown ] = useState( false );\n\tconst [ isOver, setIsOver ] = useState( false );\n\tconst delayedSetIsOver = useDebounce( setIsOver, delay );\n\t// Using internal state (instead of a ref) for the popover anchor to make sure\n\t// that the component re-renders when the anchor updates.\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\n\n\t// Create a reference to the Tooltip's child, to be passed to the Popover\n\t// so that the Tooltip can be correctly positioned. Also, merge with the\n\t// existing ref for the first child, so that its ref is preserved.\n\tconst existingChildRef = Children.toArray( children )[ 0 ]?.ref;\n\tconst mergedChildRefs = useMergeRefs( [\n\t\tsetPopoverAnchor,\n\t\texistingChildRef,\n\t] );\n\n\tconst createMouseDown = ( event ) => {\n\t\t// In firefox, the mouse down event is also fired when the select\n\t\t// list is chosen.\n\t\t// Cancel further processing because re-rendering of child components\n\t\t// causes onChange to be triggered with the old value.\n\t\t// See https://github.com/WordPress/gutenberg/pull/42483\n\t\tif ( event.target.tagName === 'OPTION' ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Preserve original child callback behavior.\n\t\temitToChild( children, 'onMouseDown', event );\n\n\t\t// On mouse down, the next `mouseup` should revert the value of the\n\t\t// instance property and remove its own event handler. The bind is\n\t\t// made on the document since the `mouseup` might not occur within\n\t\t// the bounds of the element.\n\t\tdocument.addEventListener( 'mouseup', cancelIsMouseDown );\n\t\tsetIsMouseDown( true );\n\t};\n\n\tconst createMouseUp = ( event ) => {\n\t\t// In firefox, the mouse up event is also fired when the select\n\t\t// list is chosen.\n\t\t// Cancel further processing because re-rendering of child components\n\t\t// causes onChange to be triggered with the old value.\n\t\t// See https://github.com/WordPress/gutenberg/pull/42483\n\t\tif ( event.target.tagName === 'OPTION' ) {\n\t\t\treturn;\n\t\t}\n\n\t\temitToChild( children, 'onMouseUp', event );\n\t\tdocument.removeEventListener( 'mouseup', cancelIsMouseDown );\n\t\tsetIsMouseDown( false );\n\t};\n\n\tconst createMouseEvent = ( type ) => {\n\t\tif ( type === 'mouseUp' ) return createMouseUp;\n\t\tif ( type === 'mouseDown' ) return createMouseDown;\n\t};\n\n\t/**\n\t * Prebound `isInMouseDown` handler, created as a constant reference to\n\t * assure ability to remove in component unmount.\n\t *\n\t * @type {Function}\n\t */\n\tconst cancelIsMouseDown = createMouseEvent( 'mouseUp' );\n\n\tconst createToggleIsOver = ( eventName, isDelayed ) => {\n\t\treturn ( event ) => {\n\t\t\t// Preserve original child callback behavior.\n\t\t\temitToChild( children, eventName, event );\n\n\t\t\t// Mouse events behave unreliably in React for disabled elements,\n\t\t\t// firing on mouseenter but not mouseleave.  Further, the default\n\t\t\t// behavior for disabled elements in some browsers is to ignore\n\t\t\t// mouse events. Don't bother trying to handle them.\n\t\t\t//\n\t\t\t// See: https://github.com/facebook/react/issues/4251\n\t\t\tif ( event.currentTarget.disabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// A focus event will occur as a result of a mouse click, but it\n\t\t\t// should be disambiguated between interacting with the button and\n\t\t\t// using an explicit focus shift as a cue to display the tooltip.\n\t\t\tif ( 'focus' === event.type && isMouseDown ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Needed in case unsetting is over while delayed set pending, i.e.\n\t\t\t// quickly blur/mouseleave before delayedSetIsOver is called.\n\t\t\tdelayedSetIsOver.cancel();\n\n\t\t\tconst _isOver = [ 'focus', 'mouseenter' ].includes( event.type );\n\t\t\tif ( _isOver === isOver ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isDelayed ) {\n\t\t\t\tdelayedSetIsOver( _isOver );\n\t\t\t} else {\n\t\t\t\tsetIsOver( _isOver );\n\t\t\t}\n\t\t};\n\t};\n\tconst clearOnUnmount = () => {\n\t\tdelayedSetIsOver.cancel();\n\t\tdocument.removeEventListener( 'mouseup', cancelIsMouseDown );\n\t};\n\n\t// Ignore reason: updating the deps array here could cause unexpected changes in behavior.\n\t// Deferring until a more detailed investigation/refactor can be performed.\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tuseEffect( () => clearOnUnmount, [] );\n\n\tif ( Children.count( children ) !== 1 ) {\n\t\tif ( 'development' === process.env.NODE_ENV ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(\n\t\t\t\t'Tooltip should be called with only a single child element.'\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tconst eventHandlers = {\n\t\tonMouseEnter: createToggleIsOver( 'onMouseEnter', true ),\n\t\tonMouseLeave: createToggleIsOver( 'onMouseLeave' ),\n\t\tonClick: createToggleIsOver( 'onClick' ),\n\t\tonFocus: createToggleIsOver( 'onFocus' ),\n\t\tonBlur: createToggleIsOver( 'onBlur' ),\n\t\tonMouseDown: createMouseEvent( 'mouseDown' ),\n\t};\n\n\tconst child = Children.only( children );\n\tconst { children: grandchildren, disabled } = child.props;\n\tconst getElementWithPopover = disabled\n\t\t? getDisabledElement\n\t\t: getRegularElement;\n\n\tconst popoverData = {\n\t\tanchor: popoverAnchor,\n\t\tisOver,\n\t\toffset: 4,\n\t\tposition,\n\t\tshortcut,\n\t\ttext,\n\t};\n\tconst childrenWithPopover = addPopoverToGrandchildren( {\n\t\tgrandchildren,\n\t\t...popoverData,\n\t\t...popoverProps,\n\t} );\n\n\treturn getElementWithPopover( {\n\t\tchild,\n\t\teventHandlers,\n\t\tchildrenWithPopover,\n\t\tmergedRefs: mergedChildRefs,\n\t} );\n}\n\nexport default Tooltip;\n"],"mappings":";AAAA;;AAEA;AACA;AACA;AACA,OAAOA,UAAU,MAAM,YAAY;;AAEnC;AACA;AACA;AACA,SACCC,QAAQ,EACRC,YAAY,EACZC,cAAc,EACdC,SAAS,EACTC,QAAQ,QACF,oBAAoB;AAC3B,SAASC,WAAW,EAAEC,YAAY,QAAQ,oBAAoB;;AAE9D;AACA;AACA;AACA,OAAOC,OAAO,MAAM,YAAY;AAChC,OAAOC,QAAQ,MAAM,aAAa;;AAElC;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,aAAa,GAAG,GAAG;AAEhC,MAAMC,YAAY,GAAGC,aAAA;EAAKC,SAAS,EAAC;AAAe,CAAE,CAAC;AAEtD,MAAMC,kBAAkB,GAAGA,CAAE;EAC5BC,aAAa;EACbC,KAAK;EACLC,mBAAmB;EACnBC;AACD,CAAC,KAAM;EACN,OAAOhB,YAAY,CAClBU,aAAA;IAAMC,SAAS,EAAC;EAA0B,GACvCX,YAAY,CAAES,YAAY,EAAEI,aAAc,CAAC,EAC3Cb,YAAY,CAAEc,KAAK,EAAE;IACtBG,QAAQ,EAAEF,mBAAmB;IAC7BG,GAAG,EAAEF;EACN,CAAE,CACG,CAAC,EACP;IAAE,GAAGH;EAAc,CACpB,CAAC;AACF,CAAC;AAED,MAAMM,iBAAiB,GAAGA,CAAE;EAC3BL,KAAK;EACLD,aAAa;EACbE,mBAAmB;EACnBC;AACD,CAAC,KAAM;EACN,OAAOhB,YAAY,CAAEc,KAAK,EAAE;IAC3B,GAAGD,aAAa;IAChBI,QAAQ,EAAEF,mBAAmB;IAC7BG,GAAG,EAAEF;EACN,CAAE,CAAC;AACJ,CAAC;AAED,MAAMI,yBAAyB,GAAGA,CAAE;EACnCC,MAAM;EACNC,aAAa;EACbC,MAAM;EACNC,MAAM;EACNC,QAAQ;EACRC,QAAQ;EACRC,IAAI;EACJhB,SAAS;EACT,GAAGiB;AACJ,CAAC,KACA3B,cAAc,CACbqB,aAAa,EACbC,MAAM,IACLb,aAAA,CAACJ,OAAO;EACPuB,YAAY,EAAG,KAAO;EACtBJ,QAAQ,EAAGA,QAAU;EACrBd,SAAS,EAAGb,UAAU,CAAE,oBAAoB,EAAEa,SAAU,CAAG;EAC3D,eAAY,MAAM;EAClBmB,OAAO,EAAG,KAAO;EACjBN,MAAM,EAAGA,MAAQ;EACjBH,MAAM,EAAGA,MAAQ;EACjBU,KAAK;EAAA,GACAH;AAAK,GAERD,IAAI,EACNjB,aAAA,CAACH,QAAQ;EACRI,SAAS,EAAC,8BAA8B;EACxCe,QAAQ,EAAGA;AAAU,CACrB,CACO,CAEX,CAAC;AAEF,MAAMM,WAAW,GAAGA,CAAEf,QAAQ,EAAEgB,SAAS,EAAEC,KAAK,KAAM;EACrD,IAAKnC,QAAQ,CAACoC,KAAK,CAAElB,QAAS,CAAC,KAAK,CAAC,EAAG;IACvC;EACD;EAEA,MAAMH,KAAK,GAAGf,QAAQ,CAACqC,IAAI,CAAEnB,QAAS,CAAC;;EAEvC;EACA,IAAKH,KAAK,CAACc,KAAK,CAACS,QAAQ,EAAG;IAC3B;EACD;EAEA,IAAK,OAAOvB,KAAK,CAACc,KAAK,CAAEK,SAAS,CAAE,KAAK,UAAU,EAAG;IACrDnB,KAAK,CAACc,KAAK,CAAEK,SAAS,CAAE,CAAEC,KAAM,CAAC;EAClC;AACD,CAAC;AAED,SAASI,OAAOA,CAAEV,KAAK,EAAG;EACzB,MAAM;IACLX,QAAQ;IACRQ,QAAQ,GAAG,eAAe;IAC1BE,IAAI;IACJD,QAAQ;IACRa,KAAK,GAAG/B,aAAa;IACrB,GAAGgC;EACJ,CAAC,GAAGZ,KAAK;EACT;AACD;AACA;AACA;AACA;AACA;EACC,MAAM,CAAEa,WAAW,EAAEC,cAAc,CAAE,GAAGvC,QAAQ,CAAE,KAAM,CAAC;EACzD,MAAM,CAAEoB,MAAM,EAAEoB,SAAS,CAAE,GAAGxC,QAAQ,CAAE,KAAM,CAAC;EAC/C,MAAMyC,gBAAgB,GAAGxC,WAAW,CAAEuC,SAAS,EAAEJ,KAAM,CAAC;EACxD;EACA;EACA,MAAM,CAAEM,aAAa,EAAEC,gBAAgB,CAAE,GAAG3C,QAAQ,CAAE,IAAK,CAAC;;EAE5D;EACA;EACA;EACA,MAAM4C,gBAAgB,GAAGhD,QAAQ,CAACiD,OAAO,CAAE/B,QAAS,CAAC,CAAE,CAAC,CAAE,EAAEC,GAAG;EAC/D,MAAM+B,eAAe,GAAG5C,YAAY,CAAE,CACrCyC,gBAAgB,EAChBC,gBAAgB,CACf,CAAC;EAEH,MAAMG,eAAe,GAAKhB,KAAK,IAAM;IACpC;IACA;IACA;IACA;IACA;IACA,IAAKA,KAAK,CAACiB,MAAM,CAACC,OAAO,KAAK,QAAQ,EAAG;MACxC;IACD;;IAEA;IACApB,WAAW,CAAEf,QAAQ,EAAE,aAAa,EAAEiB,KAAM,CAAC;;IAE7C;IACA;IACA;IACA;IACAmB,QAAQ,CAACC,gBAAgB,CAAE,SAAS,EAAEC,iBAAkB,CAAC;IACzDb,cAAc,CAAE,IAAK,CAAC;EACvB,CAAC;EAED,MAAMc,aAAa,GAAKtB,KAAK,IAAM;IAClC;IACA;IACA;IACA;IACA;IACA,IAAKA,KAAK,CAACiB,MAAM,CAACC,OAAO,KAAK,QAAQ,EAAG;MACxC;IACD;IAEApB,WAAW,CAAEf,QAAQ,EAAE,WAAW,EAAEiB,KAAM,CAAC;IAC3CmB,QAAQ,CAACI,mBAAmB,CAAE,SAAS,EAAEF,iBAAkB,CAAC;IAC5Db,cAAc,CAAE,KAAM,CAAC;EACxB,CAAC;EAED,MAAMgB,gBAAgB,GAAKC,IAAI,IAAM;IACpC,IAAKA,IAAI,KAAK,SAAS,EAAG,OAAOH,aAAa;IAC9C,IAAKG,IAAI,KAAK,WAAW,EAAG,OAAOT,eAAe;EACnD,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;EACC,MAAMK,iBAAiB,GAAGG,gBAAgB,CAAE,SAAU,CAAC;EAEvD,MAAME,kBAAkB,GAAGA,CAAE3B,SAAS,EAAE4B,SAAS,KAAM;IACtD,OAAS3B,KAAK,IAAM;MACnB;MACAF,WAAW,CAAEf,QAAQ,EAAEgB,SAAS,EAAEC,KAAM,CAAC;;MAEzC;MACA;MACA;MACA;MACA;MACA;MACA,IAAKA,KAAK,CAAC4B,aAAa,CAACzB,QAAQ,EAAG;QACnC;MACD;;MAEA;MACA;MACA;MACA,IAAK,OAAO,KAAKH,KAAK,CAACyB,IAAI,IAAIlB,WAAW,EAAG;QAC5C;MACD;;MAEA;MACA;MACAG,gBAAgB,CAACmB,MAAM,CAAC,CAAC;MAEzB,MAAMC,OAAO,GAAG,CAAE,OAAO,EAAE,YAAY,CAAE,CAACC,QAAQ,CAAE/B,KAAK,CAACyB,IAAK,CAAC;MAChE,IAAKK,OAAO,KAAKzC,MAAM,EAAG;QACzB;MACD;MAEA,IAAKsC,SAAS,EAAG;QAChBjB,gBAAgB,CAAEoB,OAAQ,CAAC;MAC5B,CAAC,MAAM;QACNrB,SAAS,CAAEqB,OAAQ,CAAC;MACrB;IACD,CAAC;EACF,CAAC;EACD,MAAME,cAAc,GAAGA,CAAA,KAAM;IAC5BtB,gBAAgB,CAACmB,MAAM,CAAC,CAAC;IACzBV,QAAQ,CAACI,mBAAmB,CAAE,SAAS,EAAEF,iBAAkB,CAAC;EAC7D,CAAC;;EAED;EACA;EACA;EACArD,SAAS,CAAE,MAAMgE,cAAc,EAAE,EAAG,CAAC;EAErC,IAAKnE,QAAQ,CAACoC,KAAK,CAAElB,QAAS,CAAC,KAAK,CAAC,EAAG;IACvC,IAAK,aAAa,KAAKkD,OAAO,CAACC,GAAG,CAACC,QAAQ,EAAG;MAC7C;MACAC,OAAO,CAACC,KAAK,CACZ,4DACD,CAAC;IACF;IAEA,OAAOtD,QAAQ;EAChB;EAEA,MAAMJ,aAAa,GAAG;IACrB2D,YAAY,EAAEZ,kBAAkB,CAAE,cAAc,EAAE,IAAK,CAAC;IACxDa,YAAY,EAAEb,kBAAkB,CAAE,cAAe,CAAC;IAClDc,OAAO,EAAEd,kBAAkB,CAAE,SAAU,CAAC;IACxCe,OAAO,EAAEf,kBAAkB,CAAE,SAAU,CAAC;IACxCgB,MAAM,EAAEhB,kBAAkB,CAAE,QAAS,CAAC;IACtCiB,WAAW,EAAEnB,gBAAgB,CAAE,WAAY;EAC5C,CAAC;EAED,MAAM5C,KAAK,GAAGf,QAAQ,CAACqC,IAAI,CAAEnB,QAAS,CAAC;EACvC,MAAM;IAAEA,QAAQ,EAAEK,aAAa;IAAEe;EAAS,CAAC,GAAGvB,KAAK,CAACc,KAAK;EACzD,MAAMkD,qBAAqB,GAAGzC,QAAQ,GACnCzB,kBAAkB,GAClBO,iBAAiB;EAEpB,MAAM4D,WAAW,GAAG;IACnB1D,MAAM,EAAEwB,aAAa;IACrBtB,MAAM;IACNC,MAAM,EAAE,CAAC;IACTC,QAAQ;IACRC,QAAQ;IACRC;EACD,CAAC;EACD,MAAMZ,mBAAmB,GAAGK,yBAAyB,CAAE;IACtDE,aAAa;IACb,GAAGyD,WAAW;IACd,GAAGvC;EACJ,CAAE,CAAC;EAEH,OAAOsC,qBAAqB,CAAE;IAC7BhE,KAAK;IACLD,aAAa;IACbE,mBAAmB;IACnBC,UAAU,EAAEiC;EACb,CAAE,CAAC;AACJ;AAEA,eAAeX,OAAO"}