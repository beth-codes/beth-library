{"version":3,"names":["TextInput","Text","View","TouchableOpacity","Platform","useColorScheme","Keyboard","useState","useRef","useMemo","useEffect","__","Button","Gridicons","Icon","cancelCircleFilled","cancelCircleFilledIcon","arrowLeft","arrowLeftIcon","close","closeIcon","allStyles","platformStyles","baseStyles","selector","selectModifiedStyles","styles","modifier","modifierMatcher","RegExp","modifierSelectors","Object","keys","filter","match","reduce","modifiedStyles","modifierSelector","blockElementSelector","split","mergeStyles","updateStyles","selectors","forEach","SearchControl","value","onChange","placeholder","isActive","setIsActive","currentStyles","setCurrentStyles","isDark","inputRef","onCancelTimer","isIOS","OS","darkStyles","activeStyles","activeDarkStyles","futureStyles","mergeFutureStyles","shouldUseConditions","shouldUseModified","every","should","updatedStyles","keyboardHideSubscription","addListener","onCancel","clearTimeout","current","remove","containerStyle","innerContainerStyle","inputContainerStyle","formInputStyle","placeholderStyle","inputButtonStyle","inputButtonLeftStyle","inputButtonRightStyle","cancelButtonStyle","cancelButtonTextStyle","iconStyle","rightIconStyle","clearInput","setTimeout","blur","renderLeftButton","button","createElement","label","icon","onClick","style","search","fill","color","renderRightButton","renderCancel","onPress","accessible","accessibilityRole","accessibilityLabel","accessibilityHint","focus","activeOpacity","ref","placeholderTextColor","onChangeText","onFocus"],"sources":["@wordpress/components/src/search-control/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tTextInput,\n\tText,\n\tView,\n\tTouchableOpacity,\n\tPlatform,\n\tuseColorScheme,\n\tKeyboard,\n} from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { useState, useRef, useMemo, useEffect } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { Button, Gridicons } from '@wordpress/components';\nimport {\n\tIcon,\n\tcancelCircleFilled as cancelCircleFilledIcon,\n\tarrowLeft as arrowLeftIcon,\n\tclose as closeIcon,\n} from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport allStyles from './style.scss';\nimport platformStyles from './platform-style.scss';\n\n// Merge platform specific styles with the default styles.\nconst baseStyles = { ...allStyles };\nfor ( const selector in platformStyles ) {\n\tbaseStyles[ selector ] = {\n\t\t...baseStyles[ selector ],\n\t\t...platformStyles[ selector ],\n\t};\n}\n\nfunction selectModifiedStyles( styles, modifier ) {\n\tconst modifierMatcher = new RegExp( `--${ modifier }$` );\n\tconst modifierSelectors = Object.keys( styles ).filter( ( selector ) =>\n\t\tselector.match( modifierMatcher )\n\t);\n\n\treturn modifierSelectors.reduce( ( modifiedStyles, modifierSelector ) => {\n\t\tconst blockElementSelector = modifierSelector.split( '--' )[ 0 ];\n\t\tmodifiedStyles[ blockElementSelector ] = styles[ modifierSelector ];\n\t\treturn modifiedStyles;\n\t}, {} );\n}\n\nfunction mergeStyles( styles, updateStyles, selectors ) {\n\tselectors.forEach( ( selector ) => {\n\t\tstyles[ selector ] = {\n\t\t\t...styles[ selector ],\n\t\t\t...updateStyles[ selector ],\n\t\t};\n\t} );\n\n\treturn styles;\n}\n\nfunction SearchControl( {\n\tvalue,\n\tonChange,\n\tplaceholder = __( 'Search blocks' ),\n} ) {\n\tconst [ isActive, setIsActive ] = useState( false );\n\tconst [ currentStyles, setCurrentStyles ] = useState( baseStyles );\n\n\tconst isDark = useColorScheme() === 'dark';\n\tconst inputRef = useRef();\n\tconst onCancelTimer = useRef();\n\n\tconst isIOS = Platform.OS === 'ios';\n\n\tconst darkStyles = useMemo( () => {\n\t\treturn selectModifiedStyles( baseStyles, 'dark' );\n\t}, [] );\n\n\tconst activeStyles = useMemo( () => {\n\t\treturn selectModifiedStyles( baseStyles, 'active' );\n\t}, [] );\n\n\tconst activeDarkStyles = useMemo( () => {\n\t\treturn selectModifiedStyles( baseStyles, 'active-dark' );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tlet futureStyles = { ...baseStyles };\n\n\t\tfunction mergeFutureStyles( modifiedStyles, shouldUseConditions ) {\n\t\t\tconst shouldUseModified = shouldUseConditions.every(\n\t\t\t\t( should ) => should\n\t\t\t);\n\n\t\t\tconst updatedStyles = shouldUseModified\n\t\t\t\t? modifiedStyles\n\t\t\t\t: futureStyles;\n\n\t\t\tconst selectors = Object.keys( modifiedStyles );\n\n\t\t\tfutureStyles = mergeStyles(\n\t\t\t\tfutureStyles,\n\t\t\t\tupdatedStyles,\n\t\t\t\tselectors\n\t\t\t);\n\t\t}\n\n\t\tmergeFutureStyles( activeStyles, [ isActive ] );\n\t\tmergeFutureStyles( darkStyles, [ isDark ] );\n\t\tmergeFutureStyles( activeDarkStyles, [ isActive, isDark ] );\n\n\t\tsetCurrentStyles( futureStyles );\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [ isActive, isDark ] );\n\n\tuseEffect( () => {\n\t\tconst keyboardHideSubscription = Keyboard.addListener(\n\t\t\t'keyboardDidHide',\n\t\t\t() => {\n\t\t\t\tif ( ! isIOS ) {\n\t\t\t\t\tonCancel();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\treturn () => {\n\t\t\tclearTimeout( onCancelTimer.current );\n\t\t\tkeyboardHideSubscription.remove();\n\t\t};\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [] );\n\n\tconst {\n\t\t'search-control__container': containerStyle,\n\t\t'search-control__inner-container': innerContainerStyle,\n\t\t'search-control__input-container': inputContainerStyle,\n\t\t'search-control__form-input': formInputStyle,\n\t\t'search-control__form-input-placeholder': placeholderStyle,\n\t\t'search-control__input-button': inputButtonStyle,\n\t\t'search-control__input-button-left': inputButtonLeftStyle,\n\t\t'search-control__input-button-right': inputButtonRightStyle,\n\t\t'search-control__cancel-button': cancelButtonStyle,\n\t\t'search-control__cancel-button-text': cancelButtonTextStyle,\n\t\t'search-control__icon': iconStyle,\n\t\t'search-control__right-icon': rightIconStyle,\n\t} = currentStyles;\n\n\tfunction clearInput() {\n\t\tonChange( '' );\n\t}\n\n\tfunction onCancel() {\n\t\tonCancelTimer.current = setTimeout( () => {\n\t\t\tinputRef.current.blur();\n\t\t\tclearInput();\n\t\t\tsetIsActive( false );\n\t\t}, 0 );\n\t}\n\n\tfunction renderLeftButton() {\n\t\tconst button =\n\t\t\t! isIOS && isActive ? (\n\t\t\t\t<Button\n\t\t\t\t\tlabel={ __( 'Cancel search' ) }\n\t\t\t\t\ticon={ arrowLeftIcon }\n\t\t\t\t\tonClick={ onCancel }\n\t\t\t\t\tstyle={ iconStyle }\n\t\t\t\t/>\n\t\t\t) : (\n\t\t\t\t<Icon icon={ Gridicons.search } fill={ iconStyle?.color } />\n\t\t\t);\n\n\t\treturn (\n\t\t\t<View style={ [ inputButtonStyle, inputButtonLeftStyle ] }>\n\t\t\t\t{ button }\n\t\t\t</View>\n\t\t);\n\t}\n\n\tfunction renderRightButton() {\n\t\tlet button;\n\n\t\t// Add a View element to properly center the input placeholder via flexbox.\n\t\tif ( isIOS && ! isActive ) {\n\t\t\tbutton = <View />;\n\t\t}\n\n\t\tif ( !! value ) {\n\t\t\tbutton = (\n\t\t\t\t<Button\n\t\t\t\t\tlabel={ __( 'Clear search' ) }\n\t\t\t\t\ticon={ isIOS ? cancelCircleFilledIcon : closeIcon }\n\t\t\t\t\tonClick={ clearInput }\n\t\t\t\t\tstyle={ [ iconStyle, rightIconStyle ] }\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<View style={ [ inputButtonStyle, inputButtonRightStyle ] }>\n\t\t\t\t{ button }\n\t\t\t</View>\n\t\t);\n\t}\n\n\tfunction renderCancel() {\n\t\tif ( ! isIOS ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<View style={ cancelButtonStyle }>\n\t\t\t\t<Text\n\t\t\t\t\tonPress={ onCancel }\n\t\t\t\t\tstyle={ cancelButtonTextStyle }\n\t\t\t\t\taccessible={ true }\n\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\taccessibilityLabel={ __( 'Cancel search' ) }\n\t\t\t\t\taccessibilityHint={ __( 'Cancel search' ) }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t</Text>\n\t\t\t</View>\n\t\t);\n\t}\n\n\treturn (\n\t\t<TouchableOpacity\n\t\t\tstyle={ containerStyle }\n\t\t\tonPress={ () => {\n\t\t\t\tsetIsActive( true );\n\t\t\t\tinputRef.current.focus();\n\t\t\t} }\n\t\t\tactiveOpacity={ 1 }\n\t\t>\n\t\t\t<View style={ innerContainerStyle }>\n\t\t\t\t<View style={ inputContainerStyle }>\n\t\t\t\t\t{ renderLeftButton() }\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tref={ inputRef }\n\t\t\t\t\t\tstyle={ formInputStyle }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle?.color }\n\t\t\t\t\t\tonChangeText={ onChange }\n\t\t\t\t\t\tonFocus={ () => setIsActive( true ) }\n\t\t\t\t\t\tvalue={ value }\n\t\t\t\t\t\tplaceholder={ placeholder }\n\t\t\t\t\t/>\n\t\t\t\t\t{ renderRightButton() }\n\t\t\t\t</View>\n\t\t\t\t{ isActive && renderCancel() }\n\t\t\t</View>\n\t\t</TouchableOpacity>\n\t);\n}\n\nexport default SearchControl;\n"],"mappings":"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"}