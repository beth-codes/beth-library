{"version":3,"names":["_element","require","_hooks","_components","_i18n","_blocks","_compose","_data","_store","_components2","BehaviorsControl","blockName","blockBehaviors","onChangeBehavior","onChangeAnimation","disabled","settings","useSelect","select","getSettings","blockEditorStore","__experimentalFeatures","blocks","behaviors","defaultBehaviors","default","value","label","__","noBehaviors","behaviorsOptions","Object","entries","filter","behaviorName","behaviorValue","hasBlockSupport","map","charAt","toUpperCase","slice","toLowerCase","options","values","behaviorsValue","useMemo","mergedBehaviors","undefined","lightbox","enabled","length","helpText","createElement","InspectorControls","group","SelectControl","onChange","hideCancelButton","help","size","animation","withBehaviors","createHigherOrderComponent","BlockEdit","props","blockEdit","key","name","blockHasLink","attributes","linkDestination","Fragment","nextValue","setAttributes","exports","addFilter"],"sources":["@wordpress/block-editor/src/hooks/behaviors.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { SelectControl } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { hasBlockSupport } from '@wordpress/blocks';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { useSelect } from '@wordpress/data';\nimport { useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../store';\nimport { InspectorControls } from '../components';\n\nfunction BehaviorsControl( {\n\tblockName,\n\tblockBehaviors,\n\tonChangeBehavior,\n\tonChangeAnimation,\n\tdisabled = false,\n} ) {\n\tconst { settings } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getSettings } = select( blockEditorStore );\n\t\t\treturn {\n\t\t\t\tsettings:\n\t\t\t\t\tgetSettings()?.__experimentalFeatures?.blocks?.[ blockName ]\n\t\t\t\t\t\t?.behaviors || {},\n\t\t\t};\n\t\t},\n\t\t[ blockName ]\n\t);\n\n\tconst defaultBehaviors = {\n\t\tdefault: {\n\t\t\tvalue: 'default',\n\t\t\tlabel: __( 'Default' ),\n\t\t},\n\t\tnoBehaviors: {\n\t\t\tvalue: '',\n\t\t\tlabel: __( 'No behaviors' ),\n\t\t},\n\t};\n\tconst behaviorsOptions = Object.entries( settings )\n\t\t.filter(\n\t\t\t( [ behaviorName, behaviorValue ] ) =>\n\t\t\t\thasBlockSupport( blockName, `behaviors.${ behaviorName }` ) &&\n\t\t\t\tbehaviorValue\n\t\t) // Filter out behaviors that are disabled.\n\t\t.map( ( [ behaviorName ] ) => ( {\n\t\t\tvalue: behaviorName,\n\t\t\t// Capitalize the first letter of the behavior name.\n\t\t\tlabel: `${ behaviorName.charAt( 0 ).toUpperCase() }${ behaviorName\n\t\t\t\t.slice( 1 )\n\t\t\t\t.toLowerCase() }`,\n\t\t} ) );\n\tconst options = [\n\t\t...Object.values( defaultBehaviors ),\n\t\t...behaviorsOptions,\n\t];\n\n\tconst { behaviors, behaviorsValue } = useMemo( () => {\n\t\tconst mergedBehaviors = {\n\t\t\t...( blockBehaviors || {} ),\n\t\t};\n\n\t\tlet value = '';\n\t\tif ( blockBehaviors === undefined ) {\n\t\t\tvalue = 'default';\n\t\t}\n\t\tif ( blockBehaviors?.lightbox.enabled ) {\n\t\t\tvalue = 'lightbox';\n\t\t}\n\t\treturn {\n\t\t\tbehaviors: mergedBehaviors,\n\t\t\tbehaviorsValue: value,\n\t\t};\n\t}, [ blockBehaviors ] );\n\n\t// If every behavior is disabled, do not show the behaviors inspector control.\n\tif ( behaviorsOptions.length === 0 ) {\n\t\treturn null;\n\t}\n\n\tconst helpText = disabled\n\t\t? __( 'The lightbox behavior is disabled for linked images.' )\n\t\t: '';\n\n\treturn (\n\t\t<InspectorControls group=\"advanced\">\n\t\t\t<div>\n\t\t\t\t<SelectControl\n\t\t\t\t\tlabel={ __( 'Behaviors' ) }\n\t\t\t\t\t// At the moment we are only supporting one behavior (Lightbox)\n\t\t\t\t\tvalue={ behaviorsValue }\n\t\t\t\t\toptions={ options }\n\t\t\t\t\tonChange={ onChangeBehavior }\n\t\t\t\t\thideCancelButton={ true }\n\t\t\t\t\thelp={ helpText }\n\t\t\t\t\tsize=\"__unstable-large\"\n\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t/>\n\t\t\t\t{ behaviorsValue === 'lightbox' && (\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={ __( 'Animation' ) }\n\t\t\t\t\t\t// At the moment we are only supporting one behavior (Lightbox)\n\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\tbehaviors?.lightbox.animation\n\t\t\t\t\t\t\t\t? behaviors?.lightbox.animation\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions={ [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'zoom',\n\t\t\t\t\t\t\t\tlabel: __( 'Zoom' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'fade',\n\t\t\t\t\t\t\t\tlabel: __( 'Fade' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t] }\n\t\t\t\t\t\tonChange={ onChangeAnimation }\n\t\t\t\t\t\thideCancelButton={ false }\n\t\t\t\t\t\tsize=\"__unstable-large\"\n\t\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</InspectorControls>\n\t);\n}\n\n/**\n * Override the default edit UI to include a new block inspector control for\n * assigning behaviors to blocks if behaviors are enabled in the theme.json.\n *\n * Currently, only the `core/image` block is supported.\n *\n * @param {WPComponent} BlockEdit Original component.\n *\n * @return {WPComponent} Wrapped component.\n */\nexport const withBehaviors = createHigherOrderComponent( ( BlockEdit ) => {\n\treturn ( props ) => {\n\t\tconst blockEdit = <BlockEdit key=\"edit\" { ...props } />;\n\t\t// Only add behaviors to blocks with support.\n\t\tif ( ! hasBlockSupport( props.name, 'behaviors' ) ) {\n\t\t\treturn blockEdit;\n\t\t}\n\t\tconst blockHasLink =\n\t\t\ttypeof props.attributes?.linkDestination !== 'undefined' &&\n\t\t\tprops.attributes?.linkDestination !== 'none';\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ blockEdit }\n\t\t\t\t<BehaviorsControl\n\t\t\t\t\tblockName={ props.name }\n\t\t\t\t\tblockBehaviors={ props.attributes.behaviors }\n\t\t\t\t\tonChangeBehavior={ ( nextValue ) => {\n\t\t\t\t\t\tif ( nextValue === 'default' ) {\n\t\t\t\t\t\t\tprops.setAttributes( {\n\t\t\t\t\t\t\t\tbehaviors: undefined,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// If the user selects something, it means that they want to\n\t\t\t\t\t\t\t// change the default value (true) so we save it in the attributes.\n\t\t\t\t\t\t\tprops.setAttributes( {\n\t\t\t\t\t\t\t\tbehaviors: {\n\t\t\t\t\t\t\t\t\tlightbox: {\n\t\t\t\t\t\t\t\t\t\tenabled: nextValue === 'lightbox',\n\t\t\t\t\t\t\t\t\t\tanimation:\n\t\t\t\t\t\t\t\t\t\t\tnextValue === 'lightbox'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'zoom'\n\t\t\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t\tonChangeAnimation={ ( nextValue ) => {\n\t\t\t\t\t\tprops.setAttributes( {\n\t\t\t\t\t\t\tbehaviors: {\n\t\t\t\t\t\t\t\tlightbox: {\n\t\t\t\t\t\t\t\t\tenabled:\n\t\t\t\t\t\t\t\t\t\tprops.attributes.behaviors.lightbox\n\t\t\t\t\t\t\t\t\t\t\t.enabled,\n\t\t\t\t\t\t\t\t\tanimation: nextValue,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t\tdisabled={ blockHasLink }\n\t\t\t\t/>\n\t\t\t</>\n\t\t);\n\t};\n}, 'withBehaviors' );\n\naddFilter(\n\t'editor.BlockEdit',\n\t'core/behaviors/with-inspector-control',\n\twithBehaviors\n);\n"],"mappings":"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"}