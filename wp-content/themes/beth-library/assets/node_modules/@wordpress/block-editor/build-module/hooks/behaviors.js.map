{"version":3,"names":["addFilter","SelectControl","__","hasBlockSupport","createHigherOrderComponent","useSelect","useMemo","store","blockEditorStore","InspectorControls","BehaviorsControl","blockName","blockBehaviors","onChangeBehavior","onChangeAnimation","disabled","settings","select","getSettings","__experimentalFeatures","blocks","behaviors","defaultBehaviors","default","value","label","noBehaviors","behaviorsOptions","Object","entries","filter","behaviorName","behaviorValue","map","charAt","toUpperCase","slice","toLowerCase","options","values","behaviorsValue","mergedBehaviors","undefined","lightbox","enabled","length","helpText","createElement","group","onChange","hideCancelButton","help","size","animation","withBehaviors","BlockEdit","props","blockEdit","key","name","blockHasLink","attributes","linkDestination","Fragment","nextValue","setAttributes"],"sources":["@wordpress/block-editor/src/hooks/behaviors.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { SelectControl } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { hasBlockSupport } from '@wordpress/blocks';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { useSelect } from '@wordpress/data';\nimport { useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../store';\nimport { InspectorControls } from '../components';\n\nfunction BehaviorsControl( {\n\tblockName,\n\tblockBehaviors,\n\tonChangeBehavior,\n\tonChangeAnimation,\n\tdisabled = false,\n} ) {\n\tconst { settings } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getSettings } = select( blockEditorStore );\n\t\t\treturn {\n\t\t\t\tsettings:\n\t\t\t\t\tgetSettings()?.__experimentalFeatures?.blocks?.[ blockName ]\n\t\t\t\t\t\t?.behaviors || {},\n\t\t\t};\n\t\t},\n\t\t[ blockName ]\n\t);\n\n\tconst defaultBehaviors = {\n\t\tdefault: {\n\t\t\tvalue: 'default',\n\t\t\tlabel: __( 'Default' ),\n\t\t},\n\t\tnoBehaviors: {\n\t\t\tvalue: '',\n\t\t\tlabel: __( 'No behaviors' ),\n\t\t},\n\t};\n\tconst behaviorsOptions = Object.entries( settings )\n\t\t.filter(\n\t\t\t( [ behaviorName, behaviorValue ] ) =>\n\t\t\t\thasBlockSupport( blockName, `behaviors.${ behaviorName }` ) &&\n\t\t\t\tbehaviorValue\n\t\t) // Filter out behaviors that are disabled.\n\t\t.map( ( [ behaviorName ] ) => ( {\n\t\t\tvalue: behaviorName,\n\t\t\t// Capitalize the first letter of the behavior name.\n\t\t\tlabel: `${ behaviorName.charAt( 0 ).toUpperCase() }${ behaviorName\n\t\t\t\t.slice( 1 )\n\t\t\t\t.toLowerCase() }`,\n\t\t} ) );\n\tconst options = [\n\t\t...Object.values( defaultBehaviors ),\n\t\t...behaviorsOptions,\n\t];\n\n\tconst { behaviors, behaviorsValue } = useMemo( () => {\n\t\tconst mergedBehaviors = {\n\t\t\t...( blockBehaviors || {} ),\n\t\t};\n\n\t\tlet value = '';\n\t\tif ( blockBehaviors === undefined ) {\n\t\t\tvalue = 'default';\n\t\t}\n\t\tif ( blockBehaviors?.lightbox.enabled ) {\n\t\t\tvalue = 'lightbox';\n\t\t}\n\t\treturn {\n\t\t\tbehaviors: mergedBehaviors,\n\t\t\tbehaviorsValue: value,\n\t\t};\n\t}, [ blockBehaviors ] );\n\n\t// If every behavior is disabled, do not show the behaviors inspector control.\n\tif ( behaviorsOptions.length === 0 ) {\n\t\treturn null;\n\t}\n\n\tconst helpText = disabled\n\t\t? __( 'The lightbox behavior is disabled for linked images.' )\n\t\t: '';\n\n\treturn (\n\t\t<InspectorControls group=\"advanced\">\n\t\t\t<div>\n\t\t\t\t<SelectControl\n\t\t\t\t\tlabel={ __( 'Behaviors' ) }\n\t\t\t\t\t// At the moment we are only supporting one behavior (Lightbox)\n\t\t\t\t\tvalue={ behaviorsValue }\n\t\t\t\t\toptions={ options }\n\t\t\t\t\tonChange={ onChangeBehavior }\n\t\t\t\t\thideCancelButton={ true }\n\t\t\t\t\thelp={ helpText }\n\t\t\t\t\tsize=\"__unstable-large\"\n\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t/>\n\t\t\t\t{ behaviorsValue === 'lightbox' && (\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={ __( 'Animation' ) }\n\t\t\t\t\t\t// At the moment we are only supporting one behavior (Lightbox)\n\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\tbehaviors?.lightbox.animation\n\t\t\t\t\t\t\t\t? behaviors?.lightbox.animation\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions={ [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'zoom',\n\t\t\t\t\t\t\t\tlabel: __( 'Zoom' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'fade',\n\t\t\t\t\t\t\t\tlabel: __( 'Fade' ),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t] }\n\t\t\t\t\t\tonChange={ onChangeAnimation }\n\t\t\t\t\t\thideCancelButton={ false }\n\t\t\t\t\t\tsize=\"__unstable-large\"\n\t\t\t\t\t\tdisabled={ disabled }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</InspectorControls>\n\t);\n}\n\n/**\n * Override the default edit UI to include a new block inspector control for\n * assigning behaviors to blocks if behaviors are enabled in the theme.json.\n *\n * Currently, only the `core/image` block is supported.\n *\n * @param {WPComponent} BlockEdit Original component.\n *\n * @return {WPComponent} Wrapped component.\n */\nexport const withBehaviors = createHigherOrderComponent( ( BlockEdit ) => {\n\treturn ( props ) => {\n\t\tconst blockEdit = <BlockEdit key=\"edit\" { ...props } />;\n\t\t// Only add behaviors to blocks with support.\n\t\tif ( ! hasBlockSupport( props.name, 'behaviors' ) ) {\n\t\t\treturn blockEdit;\n\t\t}\n\t\tconst blockHasLink =\n\t\t\ttypeof props.attributes?.linkDestination !== 'undefined' &&\n\t\t\tprops.attributes?.linkDestination !== 'none';\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ blockEdit }\n\t\t\t\t<BehaviorsControl\n\t\t\t\t\tblockName={ props.name }\n\t\t\t\t\tblockBehaviors={ props.attributes.behaviors }\n\t\t\t\t\tonChangeBehavior={ ( nextValue ) => {\n\t\t\t\t\t\tif ( nextValue === 'default' ) {\n\t\t\t\t\t\t\tprops.setAttributes( {\n\t\t\t\t\t\t\t\tbehaviors: undefined,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// If the user selects something, it means that they want to\n\t\t\t\t\t\t\t// change the default value (true) so we save it in the attributes.\n\t\t\t\t\t\t\tprops.setAttributes( {\n\t\t\t\t\t\t\t\tbehaviors: {\n\t\t\t\t\t\t\t\t\tlightbox: {\n\t\t\t\t\t\t\t\t\t\tenabled: nextValue === 'lightbox',\n\t\t\t\t\t\t\t\t\t\tanimation:\n\t\t\t\t\t\t\t\t\t\t\tnextValue === 'lightbox'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'zoom'\n\t\t\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t\tonChangeAnimation={ ( nextValue ) => {\n\t\t\t\t\t\tprops.setAttributes( {\n\t\t\t\t\t\t\tbehaviors: {\n\t\t\t\t\t\t\t\tlightbox: {\n\t\t\t\t\t\t\t\t\tenabled:\n\t\t\t\t\t\t\t\t\t\tprops.attributes.behaviors.lightbox\n\t\t\t\t\t\t\t\t\t\t\t.enabled,\n\t\t\t\t\t\t\t\t\tanimation: nextValue,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t\tdisabled={ blockHasLink }\n\t\t\t\t/>\n\t\t\t</>\n\t\t);\n\t};\n}, 'withBehaviors' );\n\naddFilter(\n\t'editor.BlockEdit',\n\t'core/behaviors/with-inspector-control',\n\twithBehaviors\n);\n"],"mappings":"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"}